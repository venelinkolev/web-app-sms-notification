<div class="error-display" [class]="getSeverityClass()" [class.compact]="compact" [class.resolved]="error.resolved">

    <!-- Error Header -->
    <div class="error-header">
        <div class="error-icon">
            {{ getSeverityIcon() }}
        </div>

        <div class="error-info">
            <!-- Severity & Context -->
            <div class="error-badges">
                <span class="severity-badge" [class]="getSeverityClass()">
                    {{ getSeverityLabel() }}
                </span>
                <span class="context-badge">
                    {{ getContextLabel() }}
                </span>
                @if (error.code) {
                <span class="code-badge">
                    –ö–æ–¥: {{ error.code }}
                </span>
                }
                @if (error.resolved) {
                <span class="resolved-badge">
                    ‚úì –†–µ—à–µ–Ω–æ
                </span>
                }
            </div>

            <!-- Error Message -->
            <div class="error-message">
                @if (getBulgarianMessage()) {
                <strong>{{ getBulgarianMessage() }}</strong>
                } @else {
                <strong>{{ error.message }}</strong>
                }
            </div>

            <!-- Timestamp -->
            <div class="error-timestamp">
                {{ formatTimestamp(error.timestamp) }}
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="error-actions">
            @if (showRetryButton && isRetryable() && !error.resolved) {
            <button class="btn-icon btn-retry" (click)="onRetry()" title="–û–ø–∏—Ç–∞–π –æ—Ç–Ω–æ–≤–æ">
                üîÑ
            </button>
            }

            @if (showDismissButton) {
            <button class="btn-icon btn-dismiss" (click)="onDismiss()" title="–°–∫—Ä–∏–π">
                ‚úï
            </button>
            }
        </div>
    </div>

    <!-- Recovery Suggestion -->
    @if (getRecoverySuggestion() && !error.resolved) {
    <div class="error-suggestion">
        <span class="suggestion-icon">üí°</span>
        <span class="suggestion-text">{{ getRecoverySuggestion() }}</span>
    </div>
    }

    <!-- Resolution Notes -->
    @if (error.resolved && error.resolutionNotes) {
    <div class="error-resolution">
        <strong>–ë–µ–ª–µ–∂–∫–∏ –∑–∞ —Ä–µ—à–µ–Ω–∏–µ:</strong>
        <p>{{ error.resolutionNotes }}</p>
        @if (error.resolvedAt) {
        <small>–†–µ—à–µ–Ω–æ –Ω–∞: {{ formatTimestamp(error.resolvedAt) }}</small>
        }
    </div>
    }

    <!-- Details Section (Expandable) -->
    <div class="error-details-section">
        <button class="details-toggle" (click)="toggleDetails()">
            <span class="toggle-icon">{{ detailsExpanded ? '‚ñº' : '‚ñ∂' }}</span>
            <span>{{ detailsExpanded ? '–°–∫—Ä–∏–π' : '–ü–æ–∫–∞–∂–∏' }} —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–µ—Ç–∞–π–ª–∏</span>
        </button>

        @if (detailsExpanded) {
        <div class="error-details-content">

            <!-- Technical Details -->
            @if (error.technicalDetails) {
            <div class="detail-block">
                <h4>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–µ—Ç–∞–π–ª–∏:</h4>
                <pre>{{ error.technicalDetails }}</pre>
            </div>
            }

            <!-- Metadata -->
            @if (error.metadata) {
            <div class="detail-block">
                <h4>–ú–µ—Ç–∞–¥–∞–Ω–Ω–∏:</h4>
                <pre>{{ formatMetadata(error.metadata) }}</pre>
            </div>
            }

            <!-- Stack Trace (Development only) -->
            @if (error.stackTrace) {
            <div class="detail-block">
                <h4>Stack Trace:</h4>
                <pre class="stack-trace">{{ error.stackTrace }}</pre>
            </div>
            }

            <!-- Action Buttons -->
            <div class="detail-actions">
                <button class="btn btn-sm btn-outline" (click)="copyToClipboard()">
                    üìã –ö–æ–ø–∏—Ä–∞–π –≥—Ä–µ—à–∫–∞—Ç–∞
                </button>

                @if (!error.resolved && isRecoverable()) {
                <button class="btn btn-sm btn-primary" (click)="onResolve()">
                    ‚úì –ú–∞—Ä–∫–∏—Ä–∞–π –∫–∞—Ç–æ —Ä–µ—à–µ–Ω–æ
                </button>
                }
            </div>
        </div>
        }
    </div>

</div>